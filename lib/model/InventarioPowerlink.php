<?php

/**
 * Skeleton subclass for representing a row from the 'inventario_powerlink' table.
 *
 *
 *
 * This class was autogenerated by Propel 1.6.7 on:
 *
 * 09/12/23 17:49:25
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    propel.generator.lib.model
 */
class InventarioPowerlink extends BaseInventarioPowerlink {

    static public function Productos($nombre) {

        $file = sfConfig::get("sf_upload_dir") . DIRECTORY_SEPARATOR . 'cargas' . DIRECTORY_SEPARATOR . $nombre;
//        $linea = 'InventoryNumber,RetailPrice,QuantityAvailable,CategorizingStoreNumber';
//        $Datos = $linea;
//        $Datos .= "\r\n";
        $Datos = '';
        $fh = fopen($file, "w");
//        fwrite($fh, $linea."\r\n");
        $inventario = InventarioPowerlinkQuery::create()->find();
        foreach ($inventario as $re) {
            
            $store=$re->getCategorizingStoreNumber();            
            $lista = Parametro::xml_to_array($re->getDat());
            foreach ($lista as $reg) {
            $linea = $reg['A'] . "," . $reg['B'] . "," . $reg['C'] . "," . $store; //."|".$fechaConsumo;
            fwrite($fh, $linea . "\r\n");
            $Datos .= $linea;
            $Datos .= "\r\n";
            }
        }

        fwrite($fh, $linea);
        $Datos .= $linea;
        $Datos .= "\r\n";

        fclose($fh);
        return $Datos;
    }

}
