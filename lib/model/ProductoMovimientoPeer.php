<?php



/**
 * Skeleton subclass for performing query and update operations on the 'producto_movimiento' table.
 *
 *
 *
 * This class was autogenerated by Propel 1.6.7 on:
 *
 * 01/28/22 05:24:50
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    propel.generator.lib.model
 */
class ProductoMovimientoPeer extends BaseProductoMovimientoPeer
{
        static public function MovimientoUBi($productoId, $tiendaId, $ubicacion, $cantidad)
        {
            $cantidadPrevia=0;
            $productoUbica = ProductoUbicacionQuery::create()
                    ->filterByProductoId($productoId)
                    ->filterByTiendaId($tiendaId)
                    ->filterByUbicacion($ubicacion)
                    ->findOne();
            if ($productoUbica) {
                $cantidadPrevia= $productoUbica->getCantidad();
            }
            $nuevaCantidad =$cantidadPrevia+$cantidad;        
            if (!$productoUbica) {
                $productoUbica = new ProductoUbicacion();
                $productoUbica->setProductoId($productoId);
                $productoUbica->setTiendaId($tiendaId);
                $productoUbica->setUbicacion($ubicacion);
                $productoUbica->save();
            }
            $productoUbica->setCantidad($nuevaCantidad);
            $productoUbica->save();           
            
        }                
    
}
